<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="http://www.jq22.com/jquery/font-awesome.4.6.0.css">
    <link rel="stylesheet" href="../res/js/theme/default/layer.css">
    <link rel="stylesheet" href="../res/css/common.css">
    <link rel="stylesheet" href="../res/css/shipper.css">
    <link rel="stylesheet" href="../res/css/divSelect.css">
    <link rel="stylesheet" href="../res/js/theme/default/laydate.css">
    <script src="https://cdn.bootcss.com/jquery/1.12.1/jquery.min.js"></script>
    <script src="../res/js/jquery.placeholder.js"></script>
    <script src="https://cdn.bootcss.com/html5shiv/r29/html5.min.js"></script>
    <script src="../res/js/layer.js"></script>
    <link rel="stylesheet" href="http://cache.amap.com/lbs/static/main1119.css"/>
    <script type="text/javascript" src="http://webapi.amap.com/maps?v=1.3&key=4e956e4fdfb0c22a69fc38eb0c1d5d3e&plugin=AMap.Autocomplete,AMap.PlaceSearch"></script>
    <script type="text/javascript" src="http://webapi.amap.com/maps?v=1.4.6&key=4e956e4fdfb0c22a69fc38eb0c1d5d3e&plugin=AMap.Geocoder"></script>
    <title>我的存货</title>
</head>
<style type="text/css">
    #info article .placeholder-parent{width: 414px!important;}
    #search-button{position: relative}
    .info {
        border: solid 1px silver;
    }
    div.info-top {
        position: relative;
        background: #fff;
        border-bottom: 1px solid #CCC;
        border-radius: 5px 5px 0 0;
    }
    div.info-top div {
        display: inline-block;
        color: #333333;
        font-size: 14px;
        font-weight: bold;
        line-height: 31px;
        padding: 0 25px 0 10px;
    }
    div.info-top img {
        position: absolute;
        top: 10px;
        right: 5px;
        transition-duration: 0.25s;
    }
    div.info-top img:hover {
        box-shadow: 0px 0px 5px #000;
    }
    div.info-middle {
        font-size: 12px;
        padding: 6px;
        line-height: 20px;
    }
    div.info-bottom {
        height: 0px;
        width: 100%;
        clear: both;
        text-align: center;
    }
    div.info-bottom img {
        position: relative;
        z-index: 104;
    }
    span {
        margin-left: 5px;
        font-size: 11px;
    }
    .info-middle img {
        float: left;
        margin-right: 6px;
    }
    .amap-marker .marker-route {
        position: absolute;
        width: 40px;
        height: 44px;
        color: #e90000;
        background: url(http://webapi.amap.com/theme/v1.3/images/newpc/poi-1.png) no-repeat;
        cursor: pointer;
    }
    .amap-marker .marker-marker-bus-from {
        background-position: -334px -180px;
    }
    .amap-sug-result{z-index: 99999999}
    .introduce .map{position: relative;width: 955px;height: 250px;margin: 60px auto;margin-bottom: 45px;}
    .introduce .introduce_tile_cn{margin-bottom: 20px;}
    #tipinput{box-sizing: border-box;
        border: 0;
        padding: 9px 0;
        border-left: 10px solid transparent;
        border-right: 27px solid transparent;
        line-height: 20px;
        font-size: 16px;
        height: 38px;
        color: #333;
        position: relative;
        border-radius: 2px 0 0 2px;
        float: left;
        width: 329px;
    }
    #search-button {
        pointer-events: auto;
        background: url(http://webmap0.map.bdstatic.com/wolfman/static/common/images/new/searchbox_f175577.png) no-repeat 0 -76px #3385ff;
        width: 57px;
        height: 38px;
        float: left;
        border: 0;
        padding: 0;
        cursor: pointer;
        border-radius: 0 2px 2px 0;
        box-shadow: 1px 2px 1px rgba(0,0,0,.15);
    }
    .searchbox-content .searchbox-content-button.cancel-button {
        background: url(http://webmap0.map.bdstatic.com/wolfman/static/common/images/new/searchbox_f175577.png) no-repeat 0 -38px;
    }
    .searchbox-content-button {
        box-sizing: border-box;
        float: left;
        height: 38px;
        width: 39px;
        cursor: pointer;
        position: relative;
        background: url(http://webmap0.map.bdstatic.com/wolfman/static/common/images/new/searchbox_f175577.png) no-repeat 0 -37px #fff;
    }
    .introduce ul li {
        width: 48%;
        margin:0 1%;
        float: left;
        color: #fff;
        height: auto;
        min-height: 200px;
        cursor: pointer;
    }
    .box1{padding: 20px;}
    .map{height: 305px;margin-bottom: 20px;}
</style>


<body onload="geocoder()">
<header>
    <div class="mid_box clearfix">
        <div id="logo" class="fl"><a href="/"><img src="../res/img/logo.png" alt=""></a></div>
        <div class="fr">
            <a href="">退出</a>
        </div>
    </div>
</header>
<section class="apply record" id="info">
    <div class="mid_box clearfix">
        <aside class="fl">
            <div class="navTitle">
                我是货主
            </div>
            <ul>
                <li><a href="./info.html">基本信息</a></li>
                <li class="on"><a href="./inventory.html">我的存货</a></li>
                <li><a href="./pendingApproval.html">待审核存货</a></li>
            </ul>
        </aside>
        <article class="fl clearfix">
            <div class="clearfix">
                <a href="javascript:;" class="add fl" onclick="javascript:history.back(-1);">返回</a>
            </div>
            <ul>
                <li class="clearfix">
                    <div class="title fl">货物名称：</div>
                    <div class="select-menu fl">
                        <div class="select-menu-div">
                            <div id="No1" disabled class="select-menu-input"></div>
                            <i class="fa fa-caret-down"></i>
                        </div>
                        <ul class="select-menu-ul" >
                            <li  class="select-this">货主</li>
                            <li>库主</li>
                        </ul>
                    </div>
                </li>
                <li class="clearfix">
                    <div class="title fl">货物名称：</div>
                    <div class="select-menu fl">
                        <div class="select-menu-div">
                            <div id="No2" disabled class="select-menu-input"></div>
                            <i class="fa fa-caret-down"></i>
                        </div>
                        <ul class="select-menu-ul" >
                            <li  class="select-this">货主</li>
                            <li>库主</li>
                        </ul>
                    </div>
                </li>
                <li class="clearfix">
                    <div class="title fl">货物数量（斤）：</div>
                    <input type="text" placeholder="请输入货物数量">
                </li>
                <li class="clearfix">
                    <div class="title fl">截止日期：</div>
                    <div id="date" class="fl"></div>
                </li>
                <li class="clearfix">
                    <div class="title fl">选择仓库：</div>
                    <!--<input  type="text" placeholder="请选择仓库" readonly class="depot" onclick="choose()" value=""/>-->
                    <div class="depot fl" onclick="choose()">请选择仓库</div>
                </li>
                <li class="clearfix">
                    <div class="title fl"></div>
                    <input type="button" value="申请" class="submitBtn">
                </li>
            </ul>
        </article>
    </div>
    <div class="box1" style="display: none">
        <div class="map rel">
            <div id="container" class="abs" style="height: 305px;width: 100%"></div>
            <div style="padding-top: 15px;" class="clearfix">
                <table class="fl">
                    <tr>
                        <td>
                            <input id="tipinput" class="searchbox-content-common"/>
                            <!--<div class="searchbox-content-button right-button loading-button cancel-button" data-title="清空" data-tooltip="2" onclick="cancel_button()"></div>-->
                            <button id="search-button" data-title="搜索" data-tooltip="1" onclick="search()"></button>

                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <ul>
            <li class="chooseList">
                <div class="vCenter cInfo">
                    <p>XXXXXX的仓库</p>
                    <p>山东省青岛市市北区重庆南路268号</p>
                </div>
                <div class="vCenter">
                    剩余：500斤
                </div>
                <div class="vCenter" onclick="choose1(this)">
                    <div class="chooseBtn">选择</div>
                </div>
            </li>
            <li class="chooseList">
                <div class="vCenter cInfo">
                    <p>XXXXXX的仓库1</p>
                    <p>山东省青岛市市北区重庆南路268号</p>
                </div>
                <div class="vCenter">
                    剩余：500斤
                </div>
                <div class="vCenter" onclick="choose1(this)">
                    <div class="chooseBtn">选择</div>
                </div>
            </li>
            <li class="chooseList">
                <div class="vCenter cInfo">
                    <p>XXXXXX的仓库2</p>
                    <p>山东省青岛市市北区重庆南路268号</p>
                </div>
                <div class="vCenter">
                    剩余：500斤
                </div>
                <div class="vCenter" onclick="choose1(this)">
                    <div class="chooseBtn">选择</div>
                </div>
            </li>
            <li class="chooseList">
                <div class="vCenter cInfo">
                    <p>XXXXXX的仓库3</p>
                    <p>山东省青岛市市北区重庆南路268号</p>
                </div>
                <div class="vCenter">
                    剩余：500斤
                </div>
                <div class="vCenter" onclick="choose1(this)">
                    <div class="chooseBtn">选择</div>
                </div>
            </li>
            <li class="chooseList">
                <div class="vCenter cInfo">
                    <p>XXXXXX的仓库4</p>
                    <p>山东省青岛市市北区重庆南路268号</p>
                </div>
                <div class="vCenter">
                    剩余：500斤
                </div>
                <div class="vCenter" onclick="choose1(this)">
                    <div class="chooseBtn">选择</div>
                </div>
            </li>
            <li class="chooseList">
                <div class="vCenter cInfo">
                    <p>XXXXXX的仓库5</p>
                    <p>山东省青岛市市北区重庆南路268号</p>
                </div>
                <div class="vCenter">
                    剩余：500斤
                </div>
                <div class="vCenter" onclick="choose1(this)">
                    <div class="chooseBtn">选择</div>
                </div>
            </li>
        </ul>
    </div>
</section>
<footer>
    <div class="mid_box">©2018 云仓大数据平台 版权所有</div>
</footer>
<script>
    $(function() {
        $("input").placeholder();
    });
    $(function(){
        function footerPosition(){
            $("footer").removeClass("fixed-bottom");
            var contentHeight = document.body.scrollHeight,//网页正文全文高度
                winHeight = window.innerHeight;//可视窗口高度，不包括浏览器顶部工具栏
            if(!(contentHeight > winHeight)){
                //当网页正文高度小于可视窗口高度时，为footer添加类fixed-bottom
                $("footer").addClass("fixed-bottom");
            } else {
                $("footer").removeClass("fixed-bottom");
            }
        }
        footerPosition();
        $(window).resize(footerPosition);
    });

</script>
<script src="../res/js/laydate.js"></script>

<script>
    function cancel_button(){
        $('#tipinput').val('');
    }
    function choose() {
        layer.open({
            type: 1,
            title: false,
            closeBtn: 0,
            shadeClose: true,
            skin: 'box',
            content: $('.box1')
        });
    }
    var warehouse;
    function choose1(obj) {
        warehouse=$(obj).parent().find('p').eq(0).text();
        warehouse+='('+$(obj).parent().find('p').eq(1).text()+')';
        layer.closeAll();
        $('.depot').text(warehouse)
    }

    $('section').click(function (e) {
        e.stopPropagation();
        $('.layui-laydate').remove()
    })
    $('#date').click(function (e) {
        console.log(1)
        laydate.render({
            elem: '#date',
            closeStop: '#date',
            show: true,
            trigger: 'click'
        });
        e.stopPropagation();

    })
</script>
<script src="../res/js/divSelect.js"></script>
<script>
    /**
     * 高德地图
     * @type {AMap.Map}
     */
    var map = new AMap.Map("container", {
        resizeEnable: true,
        center: [120.13101,30.264252],
        zoom: 16
    });

    var addr;
    $('#tipinput').keyup(function () {
        addr = $('#tipinput').val();
    })
    function search() {
        geocoder()
    }
    function geocoder() {
        var geocoder = new AMap.Geocoder({
            //city: "010", //城市，默认：“全国”
            radius: 1000 //范围，默认：500
        });
        //地理编码,返回地理编码结果
        geocoder.getLocation(addr, function(status, result) {
            if (status === 'complete' && result.info === 'OK') {
                geocoder_CallBack(result);
            }
        });
    }
    var title='', content,list;

    //地理编码返回结果展示
    function geocoder_CallBack(data) {
        //地理编码结果数组
        var geocode = data.geocodes[0];
        var circle = new AMap.Circle({
            center: new AMap.LngLat(geocode.location.lng, geocode.location.lat),// 圆心位置
            radius: 10000, //半径
            strokeColor: "#FF33FF", //线颜色
            strokeOpacity: 0.2, //线透明度
            strokeWeight: 3,    //线宽
            fillColor: "#1791fc", //填充色
            fillOpacity: 0.05//填充透明度
        });
        //声明一个list
        list={
            "size":4,
            "data":[
                {"x":120.033211,"y": 36.276912},
                {"x":116.397428,"y": 39.920213},
                {"x":116.403322,"y": 39.922282},
                {"x":120.033941,"y": 36.277622}
            ],
            "info":[
                {"title":"123","content":234},
                {"title":"133","content":254},
                {"title":"143","content":244},
                {"title":"0","content":234},
            ]
        }

        for(var j = 0;j < list.size; j++){
            var myObj= list.data[j];
            title=list.info[j].title;
            content=list.info[j].content;
            var myLngLat=new AMap.LngLat(myObj.x,myObj.y);
            if(circle.contains(myLngLat)){//如果点在圆内则输出
                marker = new AMap.Marker({
                    position: myLngLat,
                    map: map
                });
                addMarker(myLngLat);

            }

        }

        circle.setMap(map);//显示圆圈
        map.setFitView();//根据地图上添加的覆盖物分布情况，自动缩放地图到合适的视野级别
        // addMarker(geocode);

    }

    function addMarker(d) {
        /*var marker = new AMap.Marker({
            map: map,
            position: [ d.location.getLng(),  d.location.getLat()]
        });*/
        var marker = new AMap.Marker({
            map: map,
            position: [ d.lng,  d.lat]
        });
        var title1=title;
        var content1=content
        var infoWindow = new AMap.InfoWindow({
            isCustom: true,  //使用自定义窗体
            content: createInfoWindow(title1, content1),
            offset: new AMap.Pixel(16, -45)
        });
        marker.on("click", function(e) {
            infoWindow.open(map, marker.getPosition());
        });
    }

    //构建自定义信息窗体
    function createInfoWindow(title, content) {
        var info = document.createElement("div");
        info.className = "info";

        //可以通过下面的方式修改自定义窗体的宽高
        //info.style.width = "400px";
        // 定义顶部标题
        var top = document.createElement("div");
        var titleD = document.createElement("div");
        var closeX = document.createElement("img");
        top.className = "info-top";
        titleD.innerHTML = title;
        closeX.src = "http://webapi.amap.com/images/close2.gif";
        closeX.onclick = closeInfoWindow;

        top.appendChild(titleD);
        top.appendChild(closeX);
        info.appendChild(top);

        // 定义中部内容
        var middle = document.createElement("div");
        middle.className = "info-middle";
        middle.style.backgroundColor = 'white';
        middle.innerHTML = content;
        info.appendChild(middle);

        // 定义底部内容
        var bottom = document.createElement("div");
        bottom.className = "info-bottom";
        bottom.style.position = 'relative';
        bottom.style.top = '0px';
        bottom.style.margin = '0 auto';
        var sharp = document.createElement("img");
        sharp.src = "http://webapi.amap.com/images/sharp.png";
        bottom.appendChild(sharp);
        info.appendChild(bottom);
        return info;
    }

    //关闭信息窗体
    function closeInfoWindow() {
        map.clearInfoWindow();
    }
</script>
</body>
</html>